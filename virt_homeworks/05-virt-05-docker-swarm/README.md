# Домашнее задание к занятию "5.5. Оркестрация кластером Docker контейнеров на примере Docker Swarm"


## Задача 1

Дайте письменые ответы на следующие вопросы:

- В чём отличие режимов работы сервисов в Docker Swarm кластере: replication и global?
    > В режиме replicated нам необходимо задать количество реплик сервиса (количество идентичных задач, которые нужно запустить на разных нодах). Если есть достаточное количество вычислительных мощностей, то это количество реплик и будет выделено управляющей нодой.
    > В режиме global мы задаем таски/устанавливаем службы или приложения, которые будут запущены на каждой ноде. Мы не указываем количество тасок, которые нужно развернуть, потому что такое приложение должно быть развернуто на каждой ноде. Например, это удобно использовать для мониторинговых сервисов, так как мониторить придется каждого воркера и менеджера. Кроме того, каждый раз, когда мы добавляем новую ноду в режиме global,на этой новой ноде будет также оркестратором запущена такая таска (например, с установкой мониторингового сервиса в контейнере)
- Какой алгоритм выбора лидера используется в Docker Swarm кластере?
- Что такое Overlay Network?

## Задача 2

Создать ваш первый Docker Swarm кластер в Яндекс.Облаке

Для получения зачета, вам необходимо предоставить скриншот из терминала (консоли), с выводом команды:
```
docker node ls
```
![docker node ls]()
## Задача 3

Создать ваш первый, готовый к боевой эксплуатации кластер мониторинга, состоящий из стека микросервисов.

Для получения зачета, вам необходимо предоставить скриншот из терминала (консоли), с выводом команды:
```
docker service ls
```
![docker service ls]()
## Задача 4 (*)

Выполнить на лидере Docker Swarm кластера команду (указанную ниже) и дать письменное описание её функционала, что она делает и зачем она нужна:
```
# см.документацию: https://docs.docker.com/engine/swarm/swarm_manager_locking/
docker swarm update --autolock=true
```

>Флаг --autolock=true блокирует управляющие ноды с помощью ключа шифрования. В памяти каждой управляющей ноды хранятся закрытые ключи и данные (например, TLS ключ для шифрования сообщений между нодами или ключ, используемый для шифрования и дешифрования Raft logs на диске хранятся в незашифрованном виде, что является риском). С помощью флага --autolock=true мы сможем дополнительно защитить такие данные, так как появится дополнительный ключ шифрования, без ручного введения которого нельзя будет получить доступ к управляющей ноде.

>Установить такую блокировку на управдяющую ноду и сохранить ключ, который выведет команды:

    docker swarm update --autolock=true

>При перезагрузке ноды, блокировка вступит в силу и прежду чем получить доступ к каким-либо данным, необходимо разблокировать ноду, введя такую команду и ключ:

    docker swarm unlock

>Чтобы отключить блокировку с управляющих нод:

    docker swarm unlock
    docker swarm update --autolock=false

>Единственное неудобство блокировки управляющих нод заключается в том, что при перезапуске swarm необходимо разблокировать каждую управляющую ноду.